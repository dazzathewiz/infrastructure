---
# Configures a secrets file with your filename under {{ docker_dir }}/{{ container_name }}/secrets

- name: Create {{ container_name }} secrets folder
  become: yes
  file:
    path: "{{ docker_dir }}/{{ container_name }}/secrets"
    state: directory
    recurse: yes

- name: Ensure {{ docker_dir }}/{{ container_name }}/secrets/{{ password_file }} file is created
  become: yes
  file:
    path: "{{ docker_dir }}/{{ container_name }}/secrets/{{ password_file }}"
    owner: root
    group: root
    mode: '0600'
    state: touch

- name: Store container_password into {{ docker_dir }}/{{ container_name }}/secrets/{{ password_file }}
  become: yes
  shell: echo -n {{ container_password }} > {{ docker_dir }}/{{ container_name }}/secrets/{{ password_file }}